package readzip;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.BytesWritable;
import org.apache.hadoop.io.NullWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Job;
import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;

public class ReadZip {

	public static void main(String[] args) throws Exception {
	  Configuration conf = new Configuration();
	  Job job = Job.getInstance(conf, "read zip");
	  
	  if(args.length != 2) {
			System.err.println("Usage: ReadZip <inputtt dir> <output dir>");
			System.exit(-1);
		}
	  
	  job.setJarByClass(ReadZip.class);
	  job.setInputFormatClass(ReadZipInputFormat.class);
	  job.setMapperClass(ReadZipMapper.class);
	  //job.setNumReduceTasks(0);
	  job.setReducerClass(ReadZipReducer.class);
	  
	  //job.setOutputKeyClass(Text.class);
	  job.setOutputValueClass(BytesWritable.class);
	  
	  job.setMapOutputKeyClass(Text.class);
	  job.setOutputKeyClass(NullWritable.class);
	  
	  FileInputFormat.setInputPaths(job, new Path(args[0]));
	  FileOutputFormat.setOutputPath(job, new Path(args[1]));
	  
	  System.exit(job.waitForCompletion(true) ? 0: 1);	
	}

}
