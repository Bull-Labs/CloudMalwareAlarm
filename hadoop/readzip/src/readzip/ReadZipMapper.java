package readzip;

import java.io.IOException;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.apache.hadoop.io.BytesWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper;

public class ReadZipMapper extends Mapper<Text, BytesWritable, Text, BytesWritable> {

	public void map(Text key, BytesWritable value, Context context) throws IOException, InterruptedException {
		String filename = key.toString();
		
		/******DEBUG**********************************************/
		//Log log = LogFactory.getLog(ReadZipMapper.class);
		//log.info("------> key:  " + key.toString());
		/*****************************************************************/
		
		if(filename.endsWith("dex") || filename.startsWith("AndroidManifest"))
			context.write(key, value);
	}

}
